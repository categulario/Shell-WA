<!DOCTYPE html>
<html>

    <head>

    	<title> OS Panel </title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<style type="text/css">
            * { font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif; }
	</style>

    </head>

    <body>
    	<form action="/panel" method="post">
	    <select name="operation">
	        <option value="copy_homes">Copiar Datos de Usuarios (hogares)</option>
	        <option value="clean_homes">Limpiar Datos de Usuarios (hogares)</option>
	        <option value="firewall_realod">Recargar Reglas de Firewall </option>
		<option value="block_site">Bloquear Sitio Web </option>
		<option value="allow_site">Liberar Sitio Web </option>
	    </select>
	    <input type="submit" value="Confirmar">
	</form>
	<div id="actions"> </div>
	<p id='error'> </p>

	<script>

	    function requestLoggedActions() {
		console.log("Calling: requestLoggedActions()")
		var xhttp = new XMLHttpRequest();
		try {
		    xhttp.onreadystatechange = function () {
		        if (this.readyState == 4 && this.status == 200) {
		            console.log(`Request Status: ${this.status}`)
		            console.log(`Request Data: ${this.responseText}`)
			    buildTable(JSON.parse(xhttp.responseText));
			}
		    };
		    xhttp.open('GET', '/actions' );
		    xhttp.send();
		} catch (err) {
		    document.getElementById("error").innerHTML = err.message;
		    console.log("Error on xhr request.....")
		}
	    };

	    function buildTable(xhrResponse) {
		console.log("Calling: buildTable(xhrResponse)")
		var tableDiv = document.getElementById("actions");
		var table = document.createElement('TABLE');

		for (var i = 0; i < xhrResponse.length; i++) {
		    console.log(`Building Row: ${i}`)
		    var tr = document.createElement('TR');
		    table.appendChild(tr);
		    for (var j = 0; j < 5; j++) {
			console.log(`Building Column: ${j}`)
			var td = document.createElement('TD');
			td.width = '75';
			td.appendChild(document.createTextNode(xhrResponse[i][j]));
			tr.appendChild(td);
		    }
		}
		tableDiv.appendChild(table);
	    };

	    requestLoggedActions();

	</script>
    </body>

</html>
